<html>
<head>
<title>Pong</title>
<script src="http://davealger.com/python/embedskulptor.js"></script>
</head>
<body>
<script>
(function() {
var options = {
 "gui": {
  "show": true
 },
 "console": {
  "show": false
 },
 "code": {
  "show": false
 }
};

embedSkulptor(options,(function () {/*
####################################################################################################
# PASTE YOUR PYTHON CODE BELOW
####################################################################################################
# Implementation of classic arcade game Pong
# Author: Hung-Tu Dinh
import simplegui
import random
import time

# initialize globals - pos and vel encode vertical info for paddles
WIDTH = 750
HEIGHT = 500       
BALL_RADIUS = 20
PAD_WIDTH = 8
PAD_HEIGHT = 80
HALF_PAD_WIDTH = PAD_WIDTH / 2
HALF_PAD_HEIGHT = PAD_HEIGHT / 2
LEFT = False
RIGHT = True
player_color = ['DarkOrange','Aqua']

paddle1_pos = HEIGHT/2
paddle2_pos = HEIGHT/2

paddle1_vel = 0
paddle2_vel = 0
pad_speed = 10
score1 = 0
score2 = 0

name_a = 'Player A'
name_b = 'Player B'
name = ''
color = ''

# Explosion 
# load 81 frame sprite sheer for explosion - image generated by phaedy explosion generator, source is hasgraphics.com
EXPLOSION_CENTER = [50, 50]
EXPLOSION_SIZE = [100, 100]
EXPLOSION_DIM = [9, 9]
explosion_image = simplegui.load_image("http://commondatastorage.googleapis.com/codeskulptor-assets/explosion.hasgraphics.png")
# create timer that iterates current_sprite_center through sprite
counter = 0

# initialize ball_pos and ball_vel for new bal in middle of table
# if direction is RIGHT, the ball's velocity is upper right, else upper left
def spawn_ball(direction):
    global counter, ball_pos, ball_vel # these are vectors stored as lists
    ball_pos = [WIDTH / 2, HEIGHT/2]
    x = random.randrange(2, 5)
    y = random.randrange(1, 9)
    if direction == LEFT:
        ball_vel = [-x,-y]
    else:
        ball_vel = [x,-y]      
    counter = 0
# define event handlers
def new_game():
    global paddle1_pos, paddle2_pos, paddle1_vel, paddle2_vel  # these are numbers
    global score1, score2  # these are ints
    score1 = score2 = 0
    
    spawn_ball(random.choice([True, False]))
    
def draw(canvas):
    BG_W = 1920
    BG_H = 1200
    global color,name,name_a,name_b,counter, score1, score2, paddle1_pos, paddle2_pos, ball_pos, ball_vel, paddle1_vel, paddle2_vel 
    
    # Draw background
    canvas.draw_image(bacground_image, (BG_W / 2, BG_H / 2), (BG_W-151, BG_H-50), (WIDTH/2, HEIGHT/2), (WIDTH, HEIGHT))
    
    # draw mid line and gutters
    canvas.draw_line([WIDTH / 2, 0],[WIDTH / 2, HEIGHT], 1, "White")
    canvas.draw_line([PAD_WIDTH, 0],[PAD_WIDTH, HEIGHT], 1, "White")
    canvas.draw_line([WIDTH - PAD_WIDTH, 0],[WIDTH - PAD_WIDTH, HEIGHT], 1, "White")
          
    # Update ball position
    ball_pos[0] += ball_vel[0]
    ball_pos[1] += ball_vel[1]
    # draw ball

    if counter == 0:       
        #canvas.draw_circle(ball_pos,  BALL_RADIUS, 1,"White")
        SIZE = 754 #The diamter of the ball in pixels
        # Ball image is downloaded as ball_img
        canvas.draw_image(ball_img, (SIZE/2+135, SIZE/ 2+10), (SIZE, SIZE), ball_pos, (BALL_RADIUS*2, BALL_RADIUS*2))
        
    # collide and reflect off of left/right hand side of canvas
    if ball_pos[0] <= BALL_RADIUS+PAD_WIDTH:
        if ball_pos[1] <= paddle1_pos+PAD_HEIGHT and ball_pos[1] >= paddle1_pos-PAD_HEIGHT:
            ball_vel = [x*1.3 for x in ball_vel] # Increase the ball speed
            ball_vel[0] = - ball_vel[0]             
        else:
            if counter <81:      
                name = name_b
                color = player_color[1]
                explosion(canvas) 
                ball_vel = [0,0]
                paddle1_vel = 0
                counter += 1               
            else:
                spawn_ball(RIGHT) #Return spawn
                score2 += 1 
                counter = 0
            
            
    if ball_pos[0] >= WIDTH- BALL_RADIUS-PAD_WIDTH:
        if ball_pos[1] <= paddle2_pos+PAD_HEIGHT and ball_pos[1] >= paddle2_pos-PAD_HEIGHT:
            ball_vel = [x*1.1 for x in ball_vel] # Increase the ball speed
            ball_vel[0] = - ball_vel[0]            
        else:
            if counter <81:   
                name = name_a
                color = player_color[0]
                explosion(canvas) 
                ball_vel = [0,0]
                paddle2_vel = 0
                counter += 1
                
            else:
                spawn_ball(LEFT) #Return spawn
                score1 += 1 
                counter = 0
    # If the ball hit top and bottom
    if ball_pos[1] <= BALL_RADIUS:
        ball_vel[1] = - ball_vel[1]        
    if ball_pos[1] > HEIGHT-BALL_RADIUS:
        ball_vel[1] = - ball_vel[1]
        

    # update paddle's vertical position, keep paddle on the screen    
    paddle1_pos += paddle1_vel
    if paddle1_pos >= HEIGHT - HALF_PAD_HEIGHT:
        paddle1_pos = HEIGHT - HALF_PAD_HEIGHT        
    if paddle1_pos < HALF_PAD_HEIGHT:
       paddle1_pos = HALF_PAD_HEIGHT 
        
        
    paddle2_pos += paddle2_vel
    if paddle2_pos >= HEIGHT - HALF_PAD_HEIGHT:
        paddle2_pos = HEIGHT - HALF_PAD_HEIGHT        
    if paddle2_pos < HALF_PAD_HEIGHT:
       paddle2_pos = HALF_PAD_HEIGHT 
    # Drawing paddles with respect to paddle positions
    # Paddle 1
    p1_1 = [0, paddle1_pos-HALF_PAD_HEIGHT]
    p1_2 = [PAD_WIDTH, paddle1_pos-HALF_PAD_HEIGHT]
    p1_3 = [PAD_WIDTH, paddle1_pos+HALF_PAD_HEIGHT]
    p1_4 = [0, paddle1_pos+HALF_PAD_HEIGHT]
    canvas.draw_polygon([p1_1, p1_2,p1_3,p1_4],1, player_color[0],player_color[0])
    
    # Paddle 2
    p2_1 = [WIDTH, paddle2_pos-HALF_PAD_HEIGHT]
    p2_2 = [WIDTH-PAD_WIDTH, paddle2_pos-HALF_PAD_HEIGHT]
    p2_3 = [WIDTH-PAD_WIDTH, paddle2_pos+HALF_PAD_HEIGHT]
    p2_4 = [WIDTH, paddle2_pos+HALF_PAD_HEIGHT]
    canvas.draw_polygon([p2_1, p2_2,p2_3,p2_4],1, player_color[1],player_color[1])


    # draw scores indicator    
    canvas.draw_text(str(score1),(260,50),30,player_color[0],'monospace')
    canvas.draw_text(str(score2),(320,50),30,player_color[1],'monospace')
    
    canvas.draw_text(name_a,(20,50),30,player_color[0],'monospace')
    canvas.draw_text(name_b,(450,50),30,player_color[1],'monospace')

def explosion(canvas):      
    if counter < 60:
        canvas.draw_text(name+' wins!!',(160,200),counter,color)

    explosion_index = [counter % EXPLOSION_DIM[0], (counter // EXPLOSION_DIM[0]) % EXPLOSION_DIM[1]]
    canvas.draw_image(explosion_image, 
                    [EXPLOSION_CENTER[0] + explosion_index[0] * EXPLOSION_SIZE[0], 
                     EXPLOSION_CENTER[1] + explosion_index[1] * EXPLOSION_SIZE[1]], 
                     EXPLOSION_SIZE, ball_pos, [EXPLOSION_SIZE[0]/2,EXPLOSION_SIZE[1]/2])    
    
def keydown(key):
    global paddle1_vel, paddle2_vel
    if key==simplegui.KEY_MAP["up"]:
        paddle2_vel = -pad_speed       
    if key==simplegui.KEY_MAP["down"]:
        paddle2_vel = pad_speed
    if key==simplegui.KEY_MAP["r"]:
        paddle1_vel = -pad_speed        
    if key==simplegui.KEY_MAP["f"]:
        paddle1_vel = pad_speed
   
def keyup(key):
    global paddle1_vel, paddle2_vel
    paddle1_vel = paddle2_vel = 0

    # Restart frame    
def restart_handler():    
    new_game()
def playerA_name_handler(text):
    global name_a 
    name_a = text
def playerB_name_handler(text):
    global name_b 
    name_b = text        

    # create frame
frame = simplegui.create_frame("Pong", WIDTH, HEIGHT)
frame.set_draw_handler(draw)
frame.set_keydown_handler(keydown)
frame.set_keyup_handler(keyup)
bacground_image = simplegui.load_image('http://xn--80aqafcrtq.cc/img/7/9/5/79533.jpg')
ball_img = simplegui.load_image('http://1.bp.blogspot.com/-KCeY792JHps/T5rddCHNbuI/AAAAAAAABE8/82To6rreyFQ/s1600/football.png')
button1 = frame.add_button('Restart', restart_handler)


frame.add_input('1st Player Name:',playerA_name_handler, 100)
frame.add_input('2nd Player Name:',playerB_name_handler, 100)
frame.set_canvas_background('Green')

frame.add_label('Player A uses R and F')
frame.add_label('Player B uses Up and Down')
# start frame
new_game()
frame.start()
####################################################################################################
# PASTE YOUR PYTHON CODE ABOVE
####################################################################################################
*/}).toString().match(/[^]*\/\*([^]*)\*\/\}$/)[1]);
})();
</script>

</body>
